---
title: "Analysis Report 2: Implications of SNOR-family Genes in Non-small Cell Lung Cancer"
author: "Allison Bogisich"
date: "November 15, 2017"
output: github_document
bibliography: references.bib
csl: bioinformatics.csl
---


# Introduction

One of the most longstanding symptoms of cancer has been increased rates of cellular structure synthesis, as cancer cells are prone to exhibit specific alterations in their metabolic activities. Cancer is predicted to kill approximately 595,690 Americans in 2016, equating to about 1,630 people per
day according to the American Cancer Society. Cancer-associated metabolic reprogramming
occurs in order to support the increased production of cells via necessary increased rates of
biosynthesis of proteins, nucleic acids, and aforementioned lipids [@baenke2013hooked]. However,
not until relatively recently has research delving into the metabolic processes involved in lipid
biosynthesis and their regulation- within the context of human disease- sustained much traction.
The unique connection between lipid metabolism and cancer in humans lies within its linkage to
epidermal growth factor (EGF) proteins and their receptors [@normanno2006epidermal]. Non-small
cell lung cancer for example, is EGF specific and characterized by dramatic changes specifically
in phospholipid profiles [@marien2015non]. In 2017, non-small cell lung cancer is the most prevalent type of lung cancer, accounting for about 85 % of all lung cancer cases in the USA according to the American Cancer Society.There are many human lipid metabolism disorders associated with aberrant lipid homeostasis besides cancers, including but not limited to:Gaucher’s disease, Faber’s disease, Wolman’s disease and many others [@saltiel2001insulin, @madhusudan2004multicenter,@chanarin1975neutral]. While these diseases are fairly rare, there are few current options for treatment and the survival rates-with decent quality of life-are quite low.


SNORAs and SNORDs are small non-coding RNAs involved in RNA processing and nogalamycin biosynthesis. This biosynthesis of noglamycin is critical to anti-tumor and antibiotic functionality of cellular maintenance. Both types have been found to be dysregulated in various types of cancer and have been implicated in not only the development but also the progressions of human cancer malignancy. This additional analysis will be based on data derived from the previous work of Li and Seo et al. in non-small cell cancer patients. I hypothesize that the expression of SNOR-genes in the patient tissues examined by Li and Seo et al. will show a marked flux in their levels of expression. That in the patients will later stage cancers, there will be more expression relative to the earlier stage cancer patients. I also predict that the smoking patients will have a higher degree of abberant expression than that of the non-smokers, due to the additional carcinogens found in tobacco products [@freour2008active].

# Methods

## Sample origin and sequencing

The work of Li and her team [@li2015rna] included data from the first large scale RNA sequencing study of lung adenocarcinoma by Seo et al. [@seo2012transcriptional]. Paired surgical samples of both cancerous lung tissue and non-cancerous tissue were taken from 200 Korean patients. Only eighty-seven samples were then sequenced using RNA-seq and the Illumina TruSeq SBS Kit v3 on a HiSeq 2000 sequencer (Illumina Inc.) to obtain 100-bp paired-end reads. Of the 87 individuals whose cancer specimens were screened and sequenced, smoking history prior to diagnosis of lung cancer was provided by only 83 (47 smokers, 36 never-smokers, and four of unknown history).They were then aligned and read based on the NCBI human reference genome assembly build (build 37.1). Li et al. then downloaded Seo et al.'s RNA sequencing and phenotypic metadata for 68 patients(with 34 validated smoking and 34 non-smoking histories) from Gene Expression Omnibus (GEO) with accession number GSE40419. Comparisons were conducted based on phenotypes, including age at diagnosis,gender, and smoking history which are available from the public website (http://genome.cshlp.org/content/22/11/2109/suppl/DC1). Additionally, in order to validate genes identified in the nonsmoker group, independent RNA-seq data from six non-smoker patients were also downloaded from another GEO with accession number GSE37765 [@kim2013high]. Differential gene expression analysis was then conducted between paired normal and tumor tissue using R Bioconductor and edgeR. Genotype calling was done for single-nucleotide variants, from RNA-seq bam files, with pair-end RNA-seq reads aligned to human genome assembly Ensembl GRCh37 by Tophat.

## Computational

In order to analyze the data from Li et al., a series of both R and bash scripts were run. In the first script, the NCBI data set downloaded (using 'aspera' and 'sra-toolkit' for added efficiency) can be found here:http://ftp-trace.ncbi.nlm.nih.gov/sra/sdk/current/sratoolkit.current-ubuntu64.tar.gz. The second script facilitated the downloading of the *Homo sapien* genome via the 'Biomartr' package (Drost and Paszkowski,2017). Output was then piped into 'Ref-seq'so that we could quickly acquire all the reference genome (RNA and annotations). Subsequently, the third script contains the export path and simple for-loop that converted .sra to .fastq format and put it into our output directory. Next in the pipe was converting sequences to k-mers and building an index to map against the original reference DNA for use with 'Sailfish'[@patro2014sailfish]. Then a large amount of time was allotted for running fastqc on all fastq files and saving output to output directory, using 86 threads. Once complete, the large data set was trimmed to one of a more manageable size using 'trimmomatic' on paired-end DNA sequences in order to get rid of Illumina tags, gummy ends, suspicious quality sequences [@bolger2014trimmomatic]. Code checks were run to ensure completion of trimming step prior to running of 'Sailfish', which trimmed out base names while reading and running prior to output. All aforementioned steps were completed in TMUX, and all subsequently described steps were done in R 3.4.2 and R studio using version 1.1.383. The final script consolidated counts by matching transcript identifiers to the gene name and pooling them all together at the gene level prior to counting the number of reads that have mapped to the gene. The output table was then melted with the metadata table to create our final_table for use in exploratory data analysis using 'tidyr', in order to create more data parsing friendly long-form data . The 'ggplot2' package could then be used for visualization of data into graphic results.


# Results


```{r load-libraries, message = FALSE, echo = FALSE}
# Be sure to install these packages before running this script
# They can be installed either with the intall.packages() function
# or with the 'Packages' pane in RStudio

# load general-use packages
library("dplyr")
library("tidyr")
library("knitr")
library("ggplot2")
library("magrittr")

# this package allows for the easy inclusion of literature citations in our Rmd
# more info here: https://github.com/crsh/citr
# and here:
# http://rmarkdown.rstudio.com/authoring_bibliographies_and_citations.html
library("citr")
```

```{r load-data, message = FALSE, echo = FALSE}
# load the dataset from a compressed binary file
# it gets loaded as an object called "final_table"
# this has 3.4 million rows...so you will need to be thoughtful about
# how you analyze the data so that you don't overwhelm your laptop
load("output/final_compiled_counts/joined_count_data.RData")

# changes all columns names to lower case so Travis doesn't complain
names(final_table) %<>% tolower

# test that it loaded correctly before proceeding
stopifnot(exists("final_table"))
```



```{r make-summary-table-SNOR-top15-genes}
# here I want to pull out just the top 15 genes that either
# SNORA- or SNORD- in their base name
# have to filter it out as a subset from final_table
snor_genes <- final_table %>%
  filter(grepl("SNOR", genename)) %>%
  group_by(genename) %>%
  summarize(mean_count = mean(counts_lengthscaledtpm)) %>%
  arrange(desc(mean_count)) %>%
  head(15)

# then we can use the `kable()` function to make a nicely formatted
# markdown table
snor_genes %>%
  kable()
```
**Table 1**: The most highly expressed SNOR-family genes across all patients of both genders.

Out of a total of 297 SNOR-family genes identified in patient lung tissue samples, the breakdown between the fifteen most represented by average sequence count was not quite even. There were nine SNORD- genes to only six SNORA-genes. Total counts per type of SNORA- and SNORD-genes were 129 and 168 respectively.

 
```{r make-all-SNOR-table, echo = FALSE}
# There are many many genes in this dataset, so we can
# subset it down to just a few here to look for
# patterns in the most highly expressed
all_snor <- final_table %>%
  filter(grepl("SNOR", genename)) %>%
  group_by(gender, genename, smoking_status, cancer_stage) %>%
  summarize(mean_count = mean(counts_lengthscaledtpm)) %>%
  arrange(desc(mean_count)) %>%
  head(n = 15)
# limiting to 15 just so that the results can be
# more easily visualized

```



```{r barplot-of-highly-expressed-genes-gender, echo = FALSE}
# this code uses the same data as above, but use it to make a
# barplot by gender of patients
all_snor %>%
  ggplot(aes(x = genename,
             y = mean_count,
             fill = gender)) +
    geom_col(position = "dodge")
```
**Figure 1**: Highest expressed SNOR-genes by gender representation.

When the SNOR-genes with the greatest mean count within the experimental group are categorized by gender, there is a strong divide along the gender line. Based on the nine highest expressed SNOR-genes visualized in Fig.1, only one of them had the highest rate of expression in females. The other eight had higher expression in males, and were exclusively being expressed in males for seven. The SNORD78 gene had the highest mean count at an almost thousand count average.

```{r barplot-of-SNOR-smoking-status, echo = FALSE}
# this code uses the same data as above, but use it to make a
# barplot
all_snor %>%
  ggplot(aes(x = genename,
             y = mean_count,
             fill = smoking_status)) +
    geom_col(position = "dodge")
```
**Figure 2**: Highest expressed SNOR-genes by smoking status of patients.

The homogeneity seen when grouping the most expressed SNOR-genes by gender is much stronger than when expression levels are categorized by smoking status of the patients. Patients that were currently smoking at the time of the study had five SNOR-genes being highly expressed relative to other groups of other status, with the highest mean counts of all genes. Previous smokers had equivalent rates of over-expressing SNOR-genes, with five genes being over-expressed within the group, and the third highest mean count across all statuses. Patients whom had reportedly never smoked or had no history collected were only represented in two of the SNOR-genes with the highest mean counts. The gene SNORD44 had most variety for representation by smoking status, with current, previous, and non-smokers all having high expression rates.

```{r make-barplot-of-SNOR-smoking-status, echo = FALSE}
# this code uses the same data as above, but use it to make a
# barplot - remember geom_col() is just like
# when one would use geom_bar(stat = "identity")
all_snor %>%
  ggplot(aes(x = genename,
             y = mean_count,
             fill = cancer_stage)) +
    geom_col(position = "dodge")
```
**Figure 3**: Highest expressed SNOR-genes by cancer stage of patients.

When the stage of cancer at the time of tissue sampling is considered, the trends run almost parallel to when the genes were grouped by smoking status. However, the genes which were most expressed by current smokers were largely only at early stages of lung cancer (1A, 1B or 2B). The patients at the latter cancer stages (3A-4), did not exhibit the highest mean counts across genes. They did appear in six of the nine genes though, making of the majority of over-expressed SNOR-genes. Again, the SNORD44 gene showed great variability in cancer stage as it did when grouped by smoking status. It had one of the highest mean counts for four stages of cancer, while SNORD78 followed closely with three stages  represented.


```{r sort-out-all-snor-genes}
# take out just snor family genes from final table
# for count of total snor-genes represented
final_snor <- final_table %>%
  filter(grepl("SNOR", genename)) %>%
  group_by(genename) %>%
  summarize(mean_count = mean(counts_lengthscaledtpm)) %>%
  arrange(desc(mean_count)) %>%
  ungroup() %>%
  select(genename) %>%
  unique() %>%
  pull()
```

```{r sort-out-SNORA-genes}
# this will pull out just SNORA-genes
# for total count represented in patients
snora_genes <- final_table %>%
  filter(grepl("SNORA", genename)) %>%
  group_by(genename) %>%
  summarize(mean_count = mean(counts_lengthscaledtpm)) %>%
  arrange(desc(mean_count)) %>%
  ungroup() %>%
  select(genename) %>%
  unique() %>%
  pull()
```

```{r sort-out-SNORD-genes}
# this will pull out just SNORD-genes
# for total count represented in patients
snord_genes <- final_table %>%
  filter(grepl("SNORD", genename)) %>%
  group_by(genename) %>%
  summarize(mean_count = mean(counts_lengthscaledtpm)) %>%
  arrange(desc(mean_count)) %>%
  ungroup() %>%
  select(genename) %>%
  unique() %>%
  pull()
```
# Discussion

Given the relatively large number of genes within the SNOR-family that were undergoing high rates of expression and gene amplification in lung cancer patients, it supports my hypothesis that they have a contributing role in the complexity that is cancer development. That there were more SNORD-genes with the highest mean counts could be explained by the sheer fact that there were simply a greater number of them being represented in the samples of patients within Li et al.'s data set (Table 1). Whether there is statistical significance to their greater representation would require a larger sample size of patients of all different cancer stages and smoking statuses. However, my prediction that the patients with later stage cancers does not appear to be supported by the data. Instead, the SNOR-genes with the highest rates of amplification were from patients with early stage cancers (Fig. 3). This suggests that SNOR-genes are being most actively expressed in earlier stages of cancer and tumor development and likely confer an initial growth advantage for the cancerous cells that later becomes dampened as the tumors reach more advanced stages where growth and replication has reached a critical mass of cancerous cells. Conversely, the data supports the prediction that non-smoking patients and even patients who previously smoked would have lower rates of SNOR-gene expression relative to patients which were currently smoking (Fig. 2). Patients which had a on-going smoking habit exhibited the highest mean rates of gene amplification by far. These results demonstrate a larger variation in gene expression level in smoker patients which supports the finding from both Li and Seo’s studies. Along the gender line, male lung adenocarcinoma patients were undergoing much higher amplification of SNOR-genes than that of female cancer patients (Fig. 1). Currently, there is little biological evidence to support why there is such a large discrepancy across genders in over-expression of SNOR-genes. The main source of support is likely that there are simply far more male smokers than there are female smokers, which would be reflected in the pool of patients. According to the World Health Organization, globally, about 40% of men smoke as compared with nearly 9% of women (http://www.who.int/gender/documents/10facts_gender_tobacco_en.pdf). Future comparative studies would benefit by utilizing data sets with equivalent numbers of men and women.


Gene amplification and the consequent over-expression of amplified oncogenes have a critical role in the development of tumors, since their over-expression confers a foundation growth advantage. The ability to identify those cancerous genes that are activated during early stages of tumor production could facilitate a better ability for creating molecular genetic targets for both earlier cancer diagnosis and improved treatment therapy for the disease [@li2006identification]. Non-coding RNAs (ncRNAs), such as SNORDs, are important regulatory molecules involved in multiple physiological cellular processes. Any alterations of ncRNAs, can have a big impact on rates of tumorigenesis [@mannoor2012small]. Mannnoor's research also found that evidence has been accumulating which supports that small nucleolar RNAs (snoRNAs), another large class of ncRNAs, are much more active participants in carcinogenesis than was previously thought. Some snoRNAs exhibit differential expression patterns in a variety of human cancers and demonstrate capability to affect not only cell transformation, but also tumorigenesis, and metastasis. Given their roles in diverse cellular processes, additional research to determine differential expression patterns of cancer type-specific snoRNAs could find novel cancer biomarkers. Previous research has demonstrated that SNORs are present in stable forms and consistently measurable in blood plasma [@fortunato2014assessment]. Therefore, SNORs have great potential for further research that creates profiles based on fluid-based biomarkers for specific cancer detection.


# Sources Cited
